pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
function _init()
-- state: 0=menu
-- 1=game
 s=0
 sizex=128*3
 sizey=128*3
 camx=0
 camy=0
 animation={{1,2},{1,2},{1},{1,3}}
 speed={1,2,1,3}
 chick={}
 plants={}
 -- chicken status:
 -- 1=move
 -- 2=peck
 -- 3=stop
 -- 4=run
 next_state={{2,2,4,3},{1,1,3},{1,3},{1,1,2,3}}
 len_state={2,4,2,5}
 for i=1,100 do
  add(plants,{x=rnd(sizex),y=rnd(sizey),s=16+flr(rnd(2))})
 end
 for i=1,20 do
  vx=rnd(.5)+.5
  vy=rnd(vx/2)
  if(rnd()<.5) vx=-vx
  if(rnd()<.5) vy=-vy
  add(chick,{x=rnd(sizex),y=rnd(sizey),vx=vx,vy=vy,s=1+flr(rnd(3)),t=rnd(3),t0=rnd()})
 end
end

function _update60()
	if s==0 then
	 -- title
	 if(btnp(ðŸ…¾ï¸)) s=1
	elseif s==1 then
	 if(btnp(ðŸ…¾ï¸)) capture()
	 if(btn(â¬†ï¸)) camy-=5
	 if(btn(â¬‡ï¸)) camy+=5
	 if(btn(â¬…ï¸)) camx-=5
	 if(btn(âž¡ï¸)) camx+=5
	 if(camx<0) camx=0
	 if(camx>sizex-128) camx=sizex-128
	 if(camy<0) camy=0
	 if(camy>sizey-128) camy=sizey-128
	 camera(camx,camy)
	
	 for c in all(chick) do
	  if c.t<t() then
	   printh(c.s)
	   c.s=rnd_state(next_state[c.s+1])
	   printh(c.s)
	   c.t=t()+len_state[c.s]+rnd(1)
	  end
	  if c.s==1 then
	   c.x+=c.vx
	   c.y+=c.vy
	  elseif c.s==4 then
	   c.x+=5*c.vx
	   c.x+=5*c.vy
	  end
	  local m=5
	  if c.x<m then
	   c.vx=abs(c.vx)
	  elseif c.x>sizex-m-16 then
	   c.vx=-abs(c.vx)
	  end
	  if c.y<m then
	   c.vy=abs(c.vy)
	  elseif c.y>sizey-m-16 then
	   c.vy=-abs(c.vy)
	  end
	 end
	end
end

function rnd_state(t)
 return t[ceil(rnd(#t))]
end

function _draw()
	cls(5)
	for e in all(plants) do
	 spr(e.s,e.x,e.y)
	end
	
	for c in all(chick) do
	 spr(anim(c.s,c.t0),c.x,c.y)
	end
	
	if s==0 then
	 print("chicken catch simulator 2019!",10,30,9)
	 print("press z to start",50,40,9)
	end
end

function print_sinus(s,x,y)
end

function anim(s,t0)
 local n=((t0+t())*speed[s])
 local l=#animation[s]
 return animation[s][1+ceil(n)%l]
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000aa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070000aa0a000088080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700000a00a000080080000990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700000a00a000800880000909000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070000aaa0000888800000909000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000088000000090000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00bb0000000050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00bb00b0005555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00bb0bbb055555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbb0b005555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
b000b00b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
